# 进行各方面的知识点的补充说明

## <font size =5>.asm文件</font>
.asm文件是什么：通常是指汇编语言源代码文件


<font size=5>汇编语言</font>：汇编语言是一种低级的计算机编程语言，它与机器语言紧密相关，但比机器语言更易于理解和编写。它使用助记符来表示机器指令，这些助记符通常是英文单词的缩写，例如“MOV”表示数据传送操作，“ADD”表示加法操作等。

<font size=5>ASM文件</font>：ASM文件就是以文本形式存储的汇编语言源代码文件，它包含了用汇编语言编写的程序代码。程序员可以通过文本编辑器来编写、修改和查看ASM文件中的代码。

<font color= yellow size=5>用途：</font>
1.系统编程：由于汇编语言可以直接操作硬件资源，如CPU寄存器、内存地址等，因此可以实现对计算机硬件的精细控制，编写出高效、高性能的系统程序。例如，在编写设备驱动程序时，通过ASM文件中的代码可以直接与硬件设备进行通信，实现对设备的初始化、数据读写等操作。<br>

2.嵌入式开发：嵌入式系统通常具有资源有限、对实时性要求高等特点，汇编语言的高效性和对硬件的直接控制能力使其成为嵌入式开发中不可或缺的工具。例如，在开发微控制器程序时，ASM文件可以用于编写中断服务例程、硬件初始化代码等关键部分，以确保程序的稳定运行和高效执行。

<font color=red size=5>编译与执行:</font>
编译过程：ASM文件需要通过汇编器（Assembler）进行编译才能转换为可执行的机器代码。汇编器会将ASM文件中的汇编语言指令逐条翻译成对应的机器指令，并生成目标文件（通常是OBJ文件）。然后，目标文件可以通过链接器（Linker）与其他目标文件或库文件链接在一起，最终生成可执行的程序文件（如EXE文件）。

执行过程：生成的可执行程序文件可以直接在计算机上运行。当程序运行时，计算机的CPU会逐条读取并执行程序中的机器指令，从而实现程序的功能。


<font size=5>.asm文件 --> 汇编器 --> .o目标文件 --> .ld链接器 --> 可执行文件</font>




## <font size=5>.ld文件</font>
.ld文件是什么：是一个文本文件，它告诉链接器（ld）如何将多个编译好的代码文件（通常是.o文件）组合成一个完整的程序或可执行文件。<br>

主要作用：<br>
（1）指定程序的入口点<br>
入口点：程序开始执行的地方。比如，有一个程序，它从_start函数开始运行，你就在ld文件中写上ENTRY(_start)，告诉链接器：“这个程序从_start开始执行哦。”<br>
（2）定义内存布局<br>
内存布局：程序在内存中的位置。可以将程序的代码部分放在内存的某个位置（比如1MB处）。<br>
（3）组织代码和数据<br>
代码和数据：程序由代码（告诉计算机做什么）和数据（程序用到的各种信息）组成。ld文件告诉链接器如何把代码和数据分别放在合适的位置。比如，.text段放代码，.data段放初始化的数据，.bss段放未初始化的数据。<br>
（4）丢弃不需要的部分<br>
丢弃部分：有时候，编译器会在代码文件中生成一些我们不需要的信息（比如调试信息或注释）。ld文件可以告诉链接器把这些不需要的部分丢掉，让最终的程序更简洁。<br>
```ld
ENTRY(_start)

SECTIONS {
    . = 0x10000; /* 内核加载到1MB处 */
    
    .text : {
        *(.text)
    }
    
    .data : {
        *(.data)
    }
    
    .bss : {
        *(.bss)
    }
    
    /DISCARD/ : {
        *(.comment)
        *(.eh_frame)
    }
}

```
- ENTRY(_start)：告诉链接器，程序从_start函数开始执行。
- . = 0x10000;：告诉链接器，程序的代码从内存的1MB处开始。
- .text : { *(.text) }：把所有输入文件中的代码（.text段）放在一起。
- .data : { *(.data) }：把所有输入文件中的初始化数据（.data段）放在一起。
- .bss : { *(.bss) }：把所有输入文件中的未初始化数据（.bss段）放在一起。
- /DISCARD/ : { *(.comment) *(.eh_frame) }：丢弃所有输入文件中的注释和异常处理信息。

## <font size=5>MBR(Master Boot Record)</font>
MBR是“主引导记录”的简称，主要作用是引导操作系统启动<br>
位于硬盘的起始位置，计算机启动时，BIOS首先加载MBR到内存并执行。  

<font size=5>MBR的结构:</font><br>
MBR总大小512字节，分为三个部分：<br>

1.引导加载程序（Bootloader）<br>
位置：从第0字节到第445字节（共446字节）。<br>
功能：这部分是一个小型的程序，负责引导操作系统的启动。检查分区表，找到活动的分区，然后将该分区的引导记录加载到内存中并执行。在一些复杂的引导程序中，它还可以提供多操作系统选择菜单等高级功能。<br>


2.分区表（Partition Table）<br>
位置：从第446字节到第510字节（共64字节）。<br>
功能：分区表用于描述硬盘上的分区信息，它包含了4个分区项，每个分区项占用16字节。每个分区项包含以下信息:
- 状态字节：表示分区是否为活动分区（通常用于引导）。<br>
- 起始CHS地址：表示分区的起始位置（柱面、磁头、扇区）。<br>
- 分区类型字节：表示分区的类型（如FAT32、NTFS等）。<br>
- 结束CHS地址：表示分区的结束位置（柱面、磁头、扇区）。<br>
- 起始LBA地址：表示分区的起始位置（逻辑块地址）。<br>
- 分区大小：表示分区的大小（以扇区为单位）。<br>
```plaintest
示例：在实际的硬盘中，分区表的结构如下：
状态字节（1字节）| 起始CHS（3字节）| 分区类型（1字节）| 结束CHS（3字节）| 起始LBA（4字节）| 分区大小（4字节）
```

3.MBR签名<br>
位置：第510字节和第511字节（2字节）。<br>
功能：MBR的最后两个字节是固定的，为0xAA55。这是MBR的有效性标志，BIOS在加载MBR时会检查这两个字节，如果它们不是0xAA55，BIOS会认为该MBR无效，从而导致启动失败。